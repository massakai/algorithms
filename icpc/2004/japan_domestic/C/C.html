<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="ja">
<head><title>
Problem C: Unit Fraction Partition
</title>
<link rel="stylesheet" href="sel.css"></head>

<body>
<p align="right"><i>
ACM International Collegiate Programming Contest<br>
Japan Domestic, 2004-07-02<br>
</i></p><hr>

<h1 align="center">Problem C<br>
<U>Unit Fraction Partition</U></h1>

<div class="jp">
<p>
分子が1であり分母が正整数である分数を単位分数と呼ぶ．
正の有理数
<I>p</I>/<I>q</I>
を有限個の単位分数の和として表現したものを，
<I>p</I>/<I>q</I>
の単位分数への「分割」と呼ぶ．
例えば，
1/2 + 1/6
は
2/3
の単位分数への分割である．
足し算の順序の違いは無視する．
例えば，
1/6 + 1/2
を
1/2 + 1/6
と区別しない．
</p>
</div>

<div class="jp">
<p>
与えられた四つの正整数
<I>p</I>と
<I>q</I>と
<I>a</I>と
<I>n</I>
に対して，
<I>p</I>/<I>q</I>
の単位分数への分割で以下の二つの条件を満たすものの個数を数えなさい．
</p>
<UL>
<LI>
分割は
<I>n</I>個以下の単位分数の和である．
</LI>
<LI>
分割に含まれる単位分数の分母の積は
<I>a</I>
以下である．
</LI>
</UL>
</div>

<div class="jp">
<p>
例えば，
(<I>p</I>,<I>q</I>,<I>a</I>,<I>n</I>) = (2,3,120,3)
ならば，
4と報告しなければならない．なぜならば，
</p>
<p align="center">
<IMG
 WIDTH="104" HEIGHT="156" ALIGN="MIDDLE" BORDER="0"
 SRC="C009.gif"
 ALT="2/3 = 1/3 + 1/3 = 1/2 + 1/6 = 1/4 + 1/4 + 1/6 = 1/3 + 1/6 + 1/6">
</p>
<p>
で，条件を満たす分割が尽くされるからである．
</p>
</div>

<h2>Input</h2>

<div class="jp">
<p>
入力は，200個以下のデータセットの並びで，その後に終端行が続く．
</p>
</div>

<div class="jp">
<p>
データセットは四つの正整数
<I>p</I>
と
<I>q</I>
と
<I>a</I>
と
<I>n</I>
を含む行で，
<I>p</I>,<I>q</I> &lt;= 800
かつ
<I>a</I> &lt;= 12000
かつ
<I>n</I> &lt;= 7
を満たす．
それらの整数は空白で区切られる．
</p>
</div>

<div class="jp">
<p>
終端行は，空白で区切られた四つのゼロを含むちょうど1行で構成される．
これは入力データの一部ではなく，入力終了を表す印（しるし）である．
</p>
</div>

<h2>Output</h2>
<div class="jp">
<p>
出力は各行に一つの整数がある何行かで構成されなければならない．
その他の文字は出力中に出現してはならない．
</p>
</div>

<div class="jp">
<p>
データセット
<I>p</I>,
<I>q</I>,
<I>a</I>,
<I>n</I>
に対応する出力の整数は
<I>p</I>/<I>q</I>
の
<I>n</I>個以下の単位分数への分割で，単位分数の分母の積が
<I>a</I>
以下となるものをすべて数えた個数でなければならない．
</p>
</div>

<h2>Sample Input</h2>
<pre>
2 3 120 3
2 3 300 3
2 3 299 3
2 3 12 3
2 3 12000 7
54 795 12000 7
2 3 300 1
2 1 200 5
2 4 54 2
0 0 0 0
</pre>

<h2>Output for the Sample Input</h2>
<pre>
4
7
6
2
42
1
0
9
3
</pre>

<h2>First Input Data</h2>
<div class="jp">
<p>
<p>ここに<a href="../C/input/C1">1番目のデータ</a>がある．</p>
</p>
</div>

<hr>
<p align="right">
<i>The ACM ICPC</i></p>
</body></html>
